<%- include('partials/header') %>

<h1 class="h2 mb-4">Edit Barang: <span class="text-primary"><%= item.namaBarang %></span></h1>

<div class="bg-white p-4 rounded shadow-sm">
    <form action="/update/<%= item.id %>" method="POST">
        <div class="mb-3">
            <label for="nomorInventaris" class="form-label">Nomor Inventaris</label>
            <input type="text" class="form-control" id="nomorInventaris" name="nomorInventaris" value="<%= item.nomorInventaris %>" readonly>
        </div>

        <div class="row">
            <div class="col-md-8 mb-3">
                <label for="namaBarang" class="form-label">Nama Barang</label>
                <input type="text" class="form-control" id="namaBarang" name="namaBarang" value="<%= item.namaBarang %>" required>
            </div>
            <div class="col-md-4 mb-3">
                <label for="warna" class="form-label">Warna</label>
                <select class="form-select" id="warna" name="warna" required>
                    <% options.warna.forEach(w => { %>
                        <option value="<%= w %>" <%= item.warna === w ? 'selected' : '' %>><%= w %></option>
                    <% }) %>
                </select>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="kategori" class="form-label">Kategori</label>
                <select class="form-select" id="kategori" name="kategori" data-master="<%= JSON.stringify(masterKategori) %>" required>
                    <option value="" disabled>-- Pilih Kategori --</option>
                    <% Object.keys(masterKategori).forEach(k => { %>
                        <option value="<%= k %>" <%= item.kategori === k ? 'selected' : '' %>><%= k %></option>
                    <% }) %>
                </select>
            </div>
            <div class="col-md-6 mb-3">
                <label for="subKategori" class="form-label">Sub Kategori</label>
                <select class="form-select" id="subKategori" name="subKategori" required>
                    <option value="<%= item.subKategori %>" selected><%= item.subKategori %></option>
                </select>
            </div>
        </div>

        <div class="mb-3">
            <label for="sumberAnggaran" class="form-label">Sumber Anggaran</label>
            <select class="form-select" id="sumberAnggaran" name="sumberAnggaran" required>
                <% options.sumberAnggaran.forEach(sa => { %>
                    <option value="<%= sa %>" <%= item.sumberAnggaran === sa ? 'selected' : '' %>><%= sa %></option>
                <% }) %>
            </select>
        </div>

        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="jumlah" class="form-label">Jumlah</label>
                <input type="number" class="form-control" id="jumlah" name="jumlah" value="<%= item.jumlah %>" required>
            </div>
            <div class="col-md-4 mb-3">
                <label for="satuan" class="form-label">Satuan</label>
                <select class="form-select" id="satuan" name="satuan" required>
                    <% options.satuan.forEach(s => { %>
                        <option value="<%= s %>" <%= item.satuan === s ? 'selected' : '' %>><%= s %></option>
                    <% }) %>
                </select>
            </div>
            <div class="col-md-4 mb-3">
                 <label for="nilaiPerolehan" class="form-label">Nilai Perolehan (Rp)</label>
                <input type="number" class="form-control" id="nilaiPerolehan" name="nilaiPerolehan" value="<%= item.nilaiPerolehan %>" step="1000" required>
            </div>
        </div>

        <div class="mb-3">
            <label for="lokasiFisik" class="form-label">Lokasi Fisik</label>
            <input type="text" class="form-control" id="lokasiFisik" name="lokasiFisik" value="<%= item.lokasiFisik %>" required>
        </div>

        <div class="mb-3">
            <label for="statusKondisi" class="form-label">Status Kondisi</label>
            <select class="form-select" id="statusKondisi" name="statusKondisi" required>
                <% options.statusKondisi.forEach(s => { %>
                    <option value="<%= s %>" <%= item.statusKondisi === s ? 'selected' : '' %>><%= s %></option>
                <% }) %>
            </select>
        </div>

        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary"><i class="bi bi-save-fill"></i> Update Barang</button>
            <a href="/" class="btn btn-secondary">Batal</a>
        </div>
    </form>
</div>

<%- include('partials/footer') %>